<!DOCTYPE html>
<html>
<head>
    <title>Bookings</title>
    <!-- Google Fonts Roboto -->
    <link href="https://fonts.googleapis.com/css?family=Roboto:400,500,700&display=swap" rel="stylesheet">
    <!-- Material Icons -->
    <link href="https://fonts.googleapis.com/icon?family=Material+Icons" rel="stylesheet">
    <!-- Material UI 3 (M3) CSS via CDN (using Materialize as closest static option) -->
    <link href="https://cdnjs.cloudflare.com/ajax/libs/materialize/1.0.0/css/materialize.min.css" rel="stylesheet">
    <style>
      body {
        font-family: 'Roboto', Arial, sans-serif;
        background: #f5f5f5;
        margin: 0;
        padding: 0;
      }
      .container {
        max-width: 900px;
        margin: 40px auto;
        background: #fff;
        border-radius: 12px;
        box-shadow: 0 2px 8px rgba(0,0,0,0.07);
        padding: 32px 24px 24px 24px;
      }
      h2 {
        font-weight: 500;
        color: #1976d2;
        margin-bottom: 24px;
      }
      .responsive-table-wrapper {
        width: 100%;
        overflow-x: auto;
      }
      table.striped > tbody > tr:nth-child(odd) {
        background-color: #f2f2f2;
      }
      th {
        background: #1976d2;
        color: #fff;
        font-weight: 500;
      }
      .pagination-controls {
        margin-top: 24px;
        text-align: right;
      }
      .material-icons {
        vertical-align: middle;
      }
      .btn-flat {
        color: #1976d2;
        font-weight: 500;
        background: none;
        box-shadow: none;
        min-width: 44px;
        min-height: 44px;
        font-size: 1.1em;
        border-radius: 6px;
      }
      .btn-flat:disabled {
        color: #bdbdbd;
      }
      @media (max-width: 600px) {
        .container {
          margin: 0;
          border-radius: 0;
          padding: 12px 2px 16px 2px;
        }
        h2 {
          font-size: 1.3em;
          margin-bottom: 16px;
        }
        .pagination-controls {
          font-size: 1em;
          margin-top: 12px;
        }
        .btn-flat {
          font-size: 1em;
          min-width: 36px;
          min-height: 36px;
        }
        table {
          font-size: 0.95em;
        }
      }
    </style>
</head>
<body>
  <div class="container">
    <h2><span class="material-icons" style="font-size:32px;vertical-align:middle;">table_chart</span> Bookings</h2>
    <div class="responsive-table-wrapper"><div id="bookings-table"></div></div>
    <div class="pagination-controls" id="pagination-controls"></div>
  </div>
  <script>
    let currentPage = 1;
    const limit = 20;
    async function fetchBookings(page = 1) {
      const res = await fetch(`/api/bookings?page=${page}&limit=${limit}`);
      const data = await res.json();
      renderTable(data.bookings);
      renderPagination(data.page, data.limit, data.total);
    }
    function renderTable(bookings) {
      let html = '<table class="striped highlight responsive-table"><thead><tr><th>Booking #</th><th>Tour Date</th><th>Customer Name</th><th>Program</th><th>OP</th><th>Customer</th></tr></thead><tbody>';
      for (const b of bookings) {
        html += `<tr><td>${b.booking_number}</td><td>${b.tour_date ? b.tour_date.substring(0,10) : ''}</td><td>${b.customer_name || ''}</td><td>${b.program || ''}</td><td>${b.op ? '<span class=\'material-icons\' style=\'color:#388e3c\'>check_circle</span>' : '<span class=\'material-icons\' style=\'color:#bdbdbd\'>cancel</span>'}</td><td>${b.customer ? '<span class=\'material-icons\' style=\'color:#388e3c\'>check_circle</span>' : '<span class=\'material-icons\' style=\'color:#bdbdbd\'>cancel</span>'}</td></tr>`;
      }
      html += '</tbody></table>';
      document.getElementById('bookings-table').innerHTML = html;
    }
    function renderPagination(page, limit, total) {
      const totalPages = Math.ceil(total / limit);
      let html = '';
      html += `<button class="btn-flat" ${page <= 1 ? 'disabled' : ''} onclick="gotoPage(${page-1})"><span class="material-icons">chevron_left</span> Previous</button>`;
      html += `<span style="margin:0 16px;vertical-align:middle;">Page ${page} of ${totalPages}</span>`;
      html += `<button class="btn-flat" ${page >= totalPages ? 'disabled' : ''} onclick="gotoPage(${page+1})">Next <span class="material-icons">chevron_right</span></button>`;
      document.getElementById('pagination-controls').innerHTML = html;
    }
    function gotoPage(page) {
      currentPage = page;
      fetchBookings(page);
    }
    fetchBookings();
  </script>
</body>
</html> 